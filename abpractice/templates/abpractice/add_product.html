{% extends "./base.html" %}
{% load tailwind_filters %}
{% load widget_tweaks %}
{% block content %}
<div id="snackbar" class="fixed top-1.5 right-1.5 hidden w-[300px] mb-2 select-none border-l-4 border-green-400 bg-green-100 p-4 font-medium hover:border-green-500">Category Added</div>

    <div class="w-full block bg-gradient-to-r from-blue-100 via-purple-100 to-pink-100 p-4 flex items-center justify-center" >
        <div id="hell" class="bg-white mx-64 my- 20 py-6 px-10 w-full ">
            <div class="sm:text-3xl text-2xl font-semibold text-center text-sky-600  mb-12">
                Add Product
            </div>
          <form method="POST" enctype="multipart/form-data">
                        {% csrf_token%}
<!--        {{pro_form|crispy}}-->
              {{form.non_field_errors}}

              {{pro_form.title.label_tag}}
            {% render_field pro_form.title|add_class:"mb-2 focus:outline-none border-b w-full pb-2 border-sky-400 placeholder-gray-500"  placeholder="Title" %}
             {{pro_form.photo.label_tag}}
              {{pro_form.photo.errors}}
            {% render_field pro_form.photo|add_class:"mb-2 focus:outline-none w-full pb-2 placeholder-gray-500" accept=".png,.jpg,.jpeg"%}
              {{pro_form.description.label_tag}}
            {% render_field pro_form.description|add_class:"mb-2 focus:outline-none border-b w-full pb-2 border-sky-400 placeholder-gray-500"  placeholder="description" %}
              {{pro_form.price.label_tag}}
            {% render_field pro_form.price|add_class:"mb-2 focus:outline-none border-b w-full pb-2 border-sky-400 placeholder-gray-500"  placeholder="Price" %}
           {{pro_form.in_stock.label_tag}}
              {% render_field pro_form.in_stock|add_class:"mb-2 focus:outline-none border-b w-full pb-2 border-sky-400 placeholder-gray-500"  placeholder="Items in stock" min="1" %}
          {{pro_form.specs.label_tag}}
              {{pro_form.specs.errors}}
            {% render_field pro_form.specs|add_class:"mb-2 focus:outline-none w-full pb-2 placeholder-gray-500" accept=".pdf"%}
           {{pro_form.category.label_tag}}
              {% render_field pro_form.category|add_class:"mb-2 focus:outline-none border-b w-full pb-2 border-sky-400 placeholder-gray-500" %}


                        <input type="submit" class="mt-8 w-full flex justify-center bg-purple-800  hover:bg-purple-700 text-gray-100 p-3  rounded-lg tracking-wide font-semibold  cursor-pointer transition ease-in duration-500">
                    </form>
        </div>
    </div>
<div class="relative flex justify-center items-center">

<!--  <button onclick="showMenu(true)" class="focus:ring-2 focus:ring-offset-2 focus:ring-gray-800 focus:outline-none absolute z-0 top-48 py-2 px-7 bg-gray-800 text-white rounded text-base hover:bg-black">Open</button>-->

  <div id="menu" class="w-full h-full bg-gray-900 bg-opacity-80 hidden top-0 fixed sticky-0">
    <div class="2xl:container  2xl:mx-auto py-48 px-4 md:px-28 flex justify-center items-center">
      <div class="w-96 md:w-auto dark:bg-gray-800 relative flex flex-col justify-center items-center bg-white py-16 px-4 md:px-24 xl:py-24 xl:px-36">
        <div role="banner">

        </div>
        <div class="">
          <h1 role="main" class="text-3xl dark:text-white lg:text-4xl font-semibold leading-7 lg:leading-9 text-center text-gray-800">Add collection</h1>
        </div>
        <div class="mt">
          <form id="cat-form">
            {% csrf_token %}
<!--          {{cat_form|crispy}}-->
               {{cat_form.category_name.label_tag}}
              {% render_field cat_form.category_name|add_class:"mb-2 focus:outline-none border-b w-full pb-2 border-sky-400 placeholder-gray-500" placeholder="Category Name"%}

            <input type="submit" class="mt-6 w-full flex justify-center bg-purple-800  hover:bg-purple-700 text-gray-100 p-3  rounded-lg tracking-wide font-semibold  cursor-pointer transition ease-in duration-500">
          </form>
          </div>
         <button onclick="showMenu(true)" class="text-gray-800 dark:text-gray-400 absolute top-8 right-8 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-800" aria-label="close">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18" stroke="currentColor" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
            <path d="M6 6L18 18" stroke="currentColor" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>


 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script type="text/javascript">
    $('#cat-form').on('submit', function(event){
    event.preventDefault();
    var serializedData = $(this).serialize();
    $.ajax(
    {
        type:"POST",
        url: "",
        data: serializedData,
        success: function(data)
        {
            var successHtml = $($.parseHTML(data.html)).find("#id_category").html();
            $("#id_category").html(successHtml);

            let menu = document.getElementById("menu");
            menu.classList.toggle("hidden");

            document.getElementById('id_category_name').value = '';
            var x = document.getElementById("id_category");
            var option = document.createElement("option");
            option.id = "hello";
            option.innerHTML ='<p>Add new Category</p>'
            x.add(option);

            var x = document.getElementById("snackbar");
            x.classList.remove("hidden");
            setTimeout(function(){ x.classList.add("hidden"); }, 2000);

        }
     })
});
</script>





<script>


let menu = document.getElementById("menu");
const showMenu = (flag) => {
  menu.classList.toggle("hidden");
};

</script>


<script>
  var x = document.getElementById("id_category");
  var option = document.createElement("option");
  option.id = "hello";
  option.innerHTML ='<p>Add new Category</p>'
  x.add(option);


</script>


<script>
  const select = document.getElementById("id_category");
  select.addEventListener('change', function handleChange(event) {
  console.log(event.target.value);
  if(event.target.value == "Add new Category"){
  showMenu(true)
  document.getElementById("id_category").selectedIndex = 0;
  }
});
</script>
{% endblock %}
